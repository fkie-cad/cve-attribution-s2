FROM mongo

RUN set -eux; \
	apt-get update; \
	apt-get install -y software-properties-common; \
    add-apt-repository ppa:deadsnakes/ppa; \
	apt-get install -y \
		python3.9 \
		python3.9-distutils \
	; \
	update-alternatives --install /usr/bin/python python /usr/bin/python3.9 1; \
	update-alternatives --install /usr/bin/python3 python3 /usr/bin/python3.9 1; \
	update-alternatives --set python /usr/bin/python3.9; \
	update-alternatives --set python3 /usr/bin/python3.9; \
	apt-get install -y --no-install-recommends python3-pip; \
	rm -rf /var/lib/apt/lists/*



RUN mkdir -p /cve_updater
COPY . /cve_updater

WORKDIR /cve_updater
RUN pip3 install -r requirements.txt

COPY docker-entrypoint.sh /usr/local/bin/
RUN chmod 755 /usr/local/bin/docker-entrypoint.sh
RUN chmod 755 /cve_updater -R
